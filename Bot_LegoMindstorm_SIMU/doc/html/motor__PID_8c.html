<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TEST: /home/pmx/git/PMX/test/MotionControl/motor_PID.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TEST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_13e138d54eb8818da29c3992edef070a.html">test</a></li><li class="navelem"><a class="el" href="dir_680f7d6bba1ca4e70ebf2058458e0a61.html">MotionControl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">motor_PID.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;../log.h&quot;</code><br />
<code>#include &quot;../exception_handler.h&quot;</code><br />
<code>#include &quot;<a class="el" href="motor_8h_source.html">motor.h</a>&quot;</code><br />
<code>#include &quot;../collision.h&quot;</code><br />
<code>#include &quot;<a class="el" href="motor__PID_8h_source.html">motor_PID.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="motion__calibration_8h_source.html">motion_calibration.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for motor_PID.c:</div>
<div class="dyncontent">
<div class="center"><img src="motor__PID_8c__incl.png" border="0" usemap="#_2home_2pmx_2git_2PMX_2test_2MotionControl_2motor__PID_8c" alt=""/></div>
<map name="_2home_2pmx_2git_2PMX_2test_2MotionControl_2motor__PID_8c" id="_2home_2pmx_2git_2PMX_2test_2MotionControl_2motor__PID_8c">
<area shape="rect" id="node4" href="motor_8h.html" title="motor.h" alt="" coords="318,169,385,196"/>
<area shape="rect" id="node6" href="motor__PID_8h.html" title="motor_PID.h" alt="" coords="363,319,459,345"/>
<area shape="rect" id="node9" href="motion__calibration_8h.html" title="motion_calibration.h" alt="" coords="369,95,507,121"/>
<area shape="rect" id="node5" href="motion__priv_8h.html" title="motion_priv.h" alt="" coords="335,244,435,271"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpidSystemValues.html">pidSystemValues</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a11c02f6d103d6ccd3230ef4ef1d9aae4"><td class="memItemLeft" align="right" valign="top"><a id="a11c02f6d103d6ccd3230ef4ef1d9aae4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_D_PERIOD</b>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a11c02f6d103d6ccd3230ef4ef1d9aae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad485474bc264a5d5b75a06f469bf8bd2"><td class="memItemLeft" align="right" valign="top"><a id="ad485474bc264a5d5b75a06f469bf8bd2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_PID_SYSTEM_NUMBER</b>&#160;&#160;&#160;6</td></tr>
<tr class="separator:ad485474bc264a5d5b75a06f469bf8bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0d1c6971c6d3a4c646a76638efc55d"><td class="memItemLeft" align="right" valign="top"><a id="acf0d1c6971c6d3a4c646a76638efc55d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_PWM_VALUE</b>&#160;&#160;&#160;0x00007EFF</td></tr>
<tr class="separator:acf0d1c6971c6d3a4c646a76638efc55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0210bf1c1cac97570d0146fc8246d475"><td class="memItemLeft" align="right" valign="top"><a id="a0210bf1c1cac97570d0146fc8246d475"></a>
EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#a0210bf1c1cac97570d0146fc8246d475">pid_Init</a> ()</td></tr>
<tr class="memdesc:a0210bf1c1cac97570d0146fc8246d475"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation of the PID system. <br /></td></tr>
<tr class="separator:a0210bf1c1cac97570d0146fc8246d475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef1401a71771f9fe59c600f8d1b31dc"><td class="memItemLeft" align="right" valign="top">EXPORTED_FUNCTION PID_SYSTEM&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#afef1401a71771f9fe59c600f8d1b31dc">pid_Create</a> ()</td></tr>
<tr class="memdesc:afef1401a71771f9fe59c600f8d1b31dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new PID system.  <a href="#afef1401a71771f9fe59c600f8d1b31dc">More...</a><br /></td></tr>
<tr class="separator:afef1401a71771f9fe59c600f8d1b31dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b28f86f74eaaa4ffa2e01240a398b6"><td class="memItemLeft" align="right" valign="top"><a id="ac7b28f86f74eaaa4ffa2e01240a398b6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#ac7b28f86f74eaaa4ffa2e01240a398b6">signalErrorOverflow</a> (PID_SYSTEM system)</td></tr>
<tr class="memdesc:ac7b28f86f74eaaa4ffa2e01240a398b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function signal a very big error integral value, generally it is caused by a hardware problem. <br /></td></tr>
<tr class="separator:ac7b28f86f74eaaa4ffa2e01240a398b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c421e27545cd4de3d0e4ab2b4c6eaa9"><td class="memItemLeft" align="right" valign="top">EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#a5c421e27545cd4de3d0e4ab2b4c6eaa9">pid_Configure</a> (PID_SYSTEM system, <a class="el" href="structpidConfig.html">pidConfig</a> config)</td></tr>
<tr class="memdesc:a5c421e27545cd4de3d0e4ab2b4c6eaa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the PID system.  <a href="#a5c421e27545cd4de3d0e4ab2b4c6eaa9">More...</a><br /></td></tr>
<tr class="separator:a5c421e27545cd4de3d0e4ab2b4c6eaa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf1d916bf65520642a9aff592555c389"><td class="memItemLeft" align="right" valign="top"><a id="adf1d916bf65520642a9aff592555c389"></a>
EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#adf1d916bf65520642a9aff592555c389">pid_ConfigKP</a> (PID_SYSTEM system, uint32 kp)</td></tr>
<tr class="memdesc:adf1d916bf65520642a9aff592555c389"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure kP value of the PID system. <br /></td></tr>
<tr class="separator:adf1d916bf65520642a9aff592555c389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca743fe79825c43915fa119f9d47a270"><td class="memItemLeft" align="right" valign="top"><a id="aca743fe79825c43915fa119f9d47a270"></a>
EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#aca743fe79825c43915fa119f9d47a270">pid_ConfigKI</a> (PID_SYSTEM system, uint32 ki)</td></tr>
<tr class="memdesc:aca743fe79825c43915fa119f9d47a270"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure kI value of the PID system. <br /></td></tr>
<tr class="separator:aca743fe79825c43915fa119f9d47a270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add64ebcf61281b3ad5f6b74440f5ee84"><td class="memItemLeft" align="right" valign="top"><a id="add64ebcf61281b3ad5f6b74440f5ee84"></a>
EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#add64ebcf61281b3ad5f6b74440f5ee84">pid_ConfigKD</a> (PID_SYSTEM system, uint32 kd)</td></tr>
<tr class="memdesc:add64ebcf61281b3ad5f6b74440f5ee84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure kD value of the PID system. <br /></td></tr>
<tr class="separator:add64ebcf61281b3ad5f6b74440f5ee84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f50a70db714f0ed9a1228cba7aaa084"><td class="memItemLeft" align="right" valign="top"><a id="a3f50a70db714f0ed9a1228cba7aaa084"></a>
EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#a3f50a70db714f0ed9a1228cba7aaa084">pid_ConfigDPeriod</a> (PID_SYSTEM system, uint8 dperiod)</td></tr>
<tr class="memdesc:a3f50a70db714f0ed9a1228cba7aaa084"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure dPeriod value of the PID system. <br /></td></tr>
<tr class="separator:a3f50a70db714f0ed9a1228cba7aaa084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6566b27e806f0f5c8f8e0dec2d355708"><td class="memItemLeft" align="right" valign="top"><a id="a6566b27e806f0f5c8f8e0dec2d355708"></a>
EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#a6566b27e806f0f5c8f8e0dec2d355708">pid_ConfigIMax</a> (PID_SYSTEM system, int32 imax)</td></tr>
<tr class="memdesc:a6566b27e806f0f5c8f8e0dec2d355708"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure iMax value of the PID system. <br /></td></tr>
<tr class="separator:a6566b27e806f0f5c8f8e0dec2d355708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc8c4b217d5f75a83478b85a0cd0352"><td class="memItemLeft" align="right" valign="top">EXPORTED_FUNCTION <a class="el" href="structpidConfig.html">pidConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#aecc8c4b217d5f75a83478b85a0cd0352">pid_GetConfig</a> (PID_SYSTEM system)</td></tr>
<tr class="memdesc:aecc8c4b217d5f75a83478b85a0cd0352"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current configuration of the PID system.  <a href="#aecc8c4b217d5f75a83478b85a0cd0352">More...</a><br /></td></tr>
<tr class="separator:aecc8c4b217d5f75a83478b85a0cd0352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa503d210de0f411d756a592f3c88c16c"><td class="memItemLeft" align="right" valign="top">EXPORTED_FUNCTION int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#aa503d210de0f411d756a592f3c88c16c">pid_Compute</a> (PID_SYSTEM system, int32 error)</td></tr>
<tr class="memdesc:aa503d210de0f411d756a592f3c88c16c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the PID sum of a system.  <a href="#aa503d210de0f411d756a592f3c88c16c">More...</a><br /></td></tr>
<tr class="separator:aa503d210de0f411d756a592f3c88c16c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d4d49a43f76cb1cee476e5c485e023"><td class="memItemLeft" align="right" valign="top">EXPORTED_FUNCTION void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor__PID_8c.html#a97d4d49a43f76cb1cee476e5c485e023">pid_ResetError</a> (PID_SYSTEM system)</td></tr>
<tr class="memdesc:a97d4d49a43f76cb1cee476e5c485e023"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the integral error.  <a href="#a97d4d49a43f76cb1cee476e5c485e023">More...</a><br /></td></tr>
<tr class="separator:a97d4d49a43f76cb1cee476e5c485e023"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8fde70d27f870f6b32117942e0d12d72"><td class="memItemLeft" align="right" valign="top"><a id="a8fde70d27f870f6b32117942e0d12d72"></a>
<a class="el" href="structpidSystemValues.html">pidSystemValues</a>&#160;</td><td class="memItemRight" valign="bottom"><b>systemValues</b> [MAX_PID_SYSTEM_NUMBER]</td></tr>
<tr class="separator:a8fde70d27f870f6b32117942e0d12d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72fa45a1319d5e9dff6d1eef87b8f2b0"><td class="memItemLeft" align="right" valign="top"><a id="a72fa45a1319d5e9dff6d1eef87b8f2b0"></a>
PID_SYSTEM&#160;</td><td class="memItemRight" valign="bottom"><b>pid_Nb</b></td></tr>
<tr class="separator:a72fa45a1319d5e9dff6d1eef87b8f2b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Julien Rouviere &lt;gmail address : julien.rouviere...&gt; </dd>
<dd>
ClubElek <a href="http://clubelek.insa-lyon.fr">http://clubelek.insa-lyon.fr</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa503d210de0f411d756a592f3c88c16c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa503d210de0f411d756a592f3c88c16c">&#9670;&nbsp;</a></span>pid_Compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORTED_FUNCTION int32 pid_Compute </td>
          <td>(</td>
          <td class="paramtype">PID_SYSTEM&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the PID sum of a system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">system</td><td>The system on which we compute the PID </td></tr>
    <tr><td class="paramname">error</td><td>The difference between measured and reference values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new command to apply on the system (pwm) </dd></dl>

</div>
</div>
<a id="a5c421e27545cd4de3d0e4ab2b4c6eaa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c421e27545cd4de3d0e4ab2b4c6eaa9">&#9670;&nbsp;</a></span>pid_Configure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORTED_FUNCTION void pid_Configure </td>
          <td>(</td>
          <td class="paramtype">PID_SYSTEM&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpidConfig.html">pidConfig</a>&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the PID system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">system</td><td>The system that is configured </td></tr>
    <tr><td class="paramname">config</td><td>The new configuration </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afef1401a71771f9fe59c600f8d1b31dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afef1401a71771f9fe59c600f8d1b31dc">&#9670;&nbsp;</a></span>pid_Create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORTED_FUNCTION PID_SYSTEM pid_Create </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new PID system. </p>
<dl class="section return"><dt>Returns</dt><dd>The new system ID </dd></dl>

</div>
</div>
<a id="aecc8c4b217d5f75a83478b85a0cd0352"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc8c4b217d5f75a83478b85a0cd0352">&#9670;&nbsp;</a></span>pid_GetConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORTED_FUNCTION <a class="el" href="structpidConfig.html">pidConfig</a> pid_GetConfig </td>
          <td>(</td>
          <td class="paramtype">PID_SYSTEM&#160;</td>
          <td class="paramname"><em>system</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current configuration of the PID system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">system</td><td>The system </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current configuration of the system </dd></dl>

</div>
</div>
<a id="a97d4d49a43f76cb1cee476e5c485e023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97d4d49a43f76cb1cee476e5c485e023">&#9670;&nbsp;</a></span>pid_ResetError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORTED_FUNCTION void pid_ResetError </td>
          <td>(</td>
          <td class="paramtype">PID_SYSTEM&#160;</td>
          <td class="paramname"><em>system</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the integral error. </p>
<p>When for example the power supply of the motors is shut down, the pid accumulate error (integral term), if the power is set up again after a while, the motor will try to correct abruptly this error. To avoid this problem, we provide the following function to reset the integral of the error and all previous error for differential. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">system</td><td>The system that will be reseted </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
